{% extends 'tienda/base.html' %}
{% load static %}
 {% block content %}
  <div class="login-container">
    <h1>Crear Cuenta</h1>

    {% if form.errors %}
      <div style="color: red; margin-bottom: 15px;">
        <p>Corrige los siguientes errores:</p>
        <ul>
          {% for field in form %}
            {% for error in field.errors %}
              <li><strong>{{ field.label }}:</strong> {{ error }}</li>
            {% endfor %}
          {% endfor %}
          {% for error in form.non_field_errors %}
              <li>{{ error }}</li>
          {% endfor %}
        </ul>
      </div>
    {% endif %}

    <form action="{% url 'tienda:registro' %}" method="post" onsubmit="return validarFormulario(event)">
      {% csrf_token %}

      <div class="form-row">
        <div class="input-group">
          {{ form.username.label_tag }}
          {{ form.username }}
        </div>
        <div class="input-group">
          {{ form.email.label_tag }}
          {{ form.email }}
        </div>
      </div>

      <div class="form-row">
        <div class="input-group">
          {{ form.first_name.label_tag }}
          {{ form.first_name }}
        </div>
        <div class="input-group">
          {{ form.last_name.label_tag }}
          {{ form.last_name }}
        </div>
      </div>

      <div class="form-row">
        <div class="input-group">
          {{ form.telefono.label_tag }}
          {{ form.telefono }}
        </div>
        <div class="input-group">
          {{ form.pais.label_tag }}
          {{ form.pais }}
        </div>
      </div>

      <div class="form-row">
        <div class="input-group" style="flex: 1;">
          {{ form.tipo_usuario.label_tag }}
          {{ form.tipo_usuario }}
        </div>
      </div>

      <div class="form-row">
        <div class="input-group">
          {{ form.password1.label_tag }}
          {{ form.password1 }}
        </div>
        <div class="input-group">
          {{ form.password2.label_tag }}
          {{ form.password2 }}
        </div>
      </div>

      <button type="submit" class="btn-primary">Crear Cuenta</button>
    </form>
  </div>
{% endblock %}
{% block extra_js %}
<script>
    function validarFormulario(e) {
      const pass1 = document.getElementById('id_password1');
      const pass2 = document.getElementById('id_password2');
      if(pass1.value !== pass2.value) {
        e.preventDefault();
        alert('Las contrase√±as no coinciden');
        pass1.classList.add('invalid');
        pass2.classList.add('invalid');
        return false;
      } else {
        pass1.classList.remove('invalid');
        pass2.classList.remove('invalid');
      }
      return true;
    }
  </script>
{% endblock %}
